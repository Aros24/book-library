<div class="books-container">
  <h1>Books</h1>

  <!-- Pagination Controls -->
  <div class="pagination">
    <button (click)="previousPage()" [disabled]="page === 0">Previous</button>
    <span>Page {{ page + 1 }}</span>
    <button (click)="nextPage()" [disabled]="(page + 1) * size >= totalBooks">Next</button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading">
    Loading books...
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error">
    Failed to load books. Please try again later.
  </div>
  <!-- Add Book Button -->
  <button (click)="toggleAddBookModal()">Add New Book</button>

  <!-- Add Book Modal -->
  <app-add-book
    *ngIf="showAddBookModal"
    (bookAdded)="onBookAdded()"
  ></app-add-book>

  <!-- Books List -->
  <table *ngIf="!loading && books.length > 0" class="book-list">
    <thead>
      <tr>
        <th>Picture</th>
        <th>Title</th>
        <th>ISBN</th>
        <th>Amount</th>
        <th>Year</th>
        <th>Publisher</th>
        <th>Authors</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let book of books">
        <td>
          <img [src]="getCoverUrl(book.isbn)" alt="Book Cover" width="50">
        </td>
        <td>{{ book.title }}</td>
        <td>{{ book.isbn }}</td>
        <td>
          <button (click)="changeAmount(book.public_id, book.amount - 1, book.amount)" [disabled]="book.amount <= 0">-</button>
          <input 
            type="number" 
            [value]="book.amount" 
            (change)="changeAmountFromEvent(book.public_id, $event, book.amount)" 
            class="amount-input" 
          />
          <button (click)="changeAmount(book.public_id, book.amount + 1, book.amount)">+</button>
        </td>        
        <td>{{ book.publication_year }}</td>
        <td>{{ book.publisher }}</td>
        <td>
          <ul>
            <li *ngFor="let author of book.authors">
              {{ author.name }} ({{ author.birth_year }})
            </li>
          </ul>
        </td>
        <td>
          <!-- Rent Book Button -->
          <button 
            (click)="rentBook(book.public_id, book.amount)" 
            [disabled]="book.amount <= 0">
            Rent Book
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- No Books State -->
  <div *ngIf="!loading && books.length === 0" class="no-books">
    No books available.
  </div>
</div>
